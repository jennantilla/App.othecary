{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="hide alert alert-warning" role="alert" id="running-low"></div>

<div class="container">
    <div class="row">
        <div class="col"><h1>Welcome back, {{ user.name }}!</h1></div>
    </div>
</div>


{% if history %}
<div class="container">
    <div class="row justify-content-between">
        <div class="col-6">
                <div id="question">
                    <form class="form-inline" id="performance" action="/update-streak" method='POST'>
                            <h3>Did you take your supplements today?</h3>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input hide" type="radio" id="yes" name="streak" value="yes">
                                <label for="yes" alt="no"><i class="far fa-check-circle fa-2x"></i></label>
                                <input class="form-check-input hide" type="radio" id="no" name="streak" value="no">
                                <label for="no" alt="no"><i class="far fa-times-circle fa-2x"></i></label>
                                <input class="m-1 form-control" type="text" name="notes" style="width:270px" placeholder="How are you feeling?">
                                <button class="m-1 btn btn-primary btn-sm" type="submit" id="streak-button" value="Update streak">Update streak</button>
                            </div>
                    </form>
                </div>
                

                {% if log|length > 0 %}
                <div id="streak-sentence"><h4>You're on a <span id="streak-info">{{ user.streak_days }}</span> day streak</h4></div>

                <div class="success-chart" style="width:400px">
                <canvas id="successChart"></canvas>
                </div> 
                <br>
                <br>
                <br>

                <h3 class="dash-head">{{ user.name }}'s Logs</h3>
                <form id="log-form" action="/see-log.json" method="POST">
                    <div id="user-log"><select id="log-search" name="log-results[]" style="width:100%" multiple="multiple"></select></div>
                    <button class="m-1 btn btn-primary btn-sm" type="submit" id="log-btn">See log details</button>
                </form>
                <br>
                <div id="log-report"></div>
                <br>
                <br>

                {% endif %}
        </div>
        <div class="col-5"><h3 class="dash-head">Routine for {{ today.strftime("%B %d, %Y") }}</h3>
            <div id="active-section"></div>
        </div>
        
    </div>
</div>

<div class="container">
    <div class="row justify-content-between">
        <div class="col-5 offset-7">
            <div id="inactive-section">
            <button type="button" class="collapsible btn btn-primary btn-lg btn-block">{{ user.name }}'s Inactive Supplements</button>
            <div class="content" id="inactive"></div>
        </div>
    </div>
</div>      
        
{% else %}
<div class="container">
    <div class="row justify-content-between">
        <div class="col-6">
            <h3 class="dash-head">You have no active supplements in your routine.</h3>
            <p>Check out the sidebar for some targeted topics that may interest you or
            <a href=/supplements>start your research.</a></p>
        </div>
    </div>
</div>

{% endif %}

<div class="container">
    <div class="row justify-content-between">
        <div class="col-6">
            <h3 class="dash-head">Resources</h3>
            <h6>As a {{ user_age }} year old {{ user.sex }}, you may be interested in the following topics:</h6>

            {% if user.diet == "vegetarian" or user.diet == "vegan" %}

            <h6>As a {{ user.diet }}, you may need to supplement your diet with some essential nutritional supplements:</h6>

            {% endif %}
        </div>
    </div>
</div>

<!-- <script>
    $('label').on('click', function() {
        this.removeClass('active');
    })
</script> -->
             
<script src="/static/js/dashboard-charts.js"></script>
<script src="/static/js/dashboard-functionality.js"></script>
<script src="/static/js/dynamic-divs.js"></script>
<script src="/static/js/user-log.js"></script>

{% endblock %}
